{% include "Info_App/base/form_header.html" %}
{% load static %}
<body>
    <div class="page-wrapper bg-gra-01 p-t-45 p-b-50">
        <div class="wrapper wrapper--w790">
            <div class="card card-5">
                <div class="card-heading">
                    <h2 class="title">ICAI Members Detail Form</h2>
                </div>          
                <div class="card-body">
                  <form action="" id="edit_ca_form" method="POST" enctype="multipart/form-data" autocomplete="off">{% csrf_token %}
                      
                      <hr style="margin-left:200px"><h4 style="margin-top:-10px"><b>Personal Information</b></h4><br>

                      <div class="form-row ">
                        <div class="value">
                            <div class="row row-space">
                                <div class="col-1">
                                  <div class="name">First Name</div>

                                    <div class="input-group-desc">
                                      <input class="input--style-5" type="text" name="member_firstname" id="member_firstname" value="{{mymodel.member_firstname}}">
                                    </div>
                                </div>
                                <div class="col-1">
                                  <div class="name">Middle Name</div>
                                    <div class="input-group-desc">
                                        <input class="input--style-5 " type="text"  name="member_middlename" id="member_middlename" value="{{mymodel.member_middlename}}">
                                      </div>
                                </div>
                                <div class="col-1">
                                  <div class="name">Last Name</div>

                                    <div class="input-group-desc">
                                        <input class="input--style-5" type="text"  name="member_lastname" id="member_lastname" value="{{mymodel.member_lastname}}">
                                      </div>
                                </div>
                            </div>
                        </div>
                    </div> 
                    <div class="form-row">
                      <div class="value">
                          <div class="row row-space">
                            <div class="col-2">
                              <div class="name">Membership Number</div>
                                <div class="input-group-desc">
                                    <input class="input--style-5 " type="number" name="membership_number" id="membership_number" value="{{mymodel.membership_number}}"   >
                                  </div>
                            </div>
                              <div class="col-2">
                                <div class="name">Membership Year</div>
                                  <div class="input-group-desc">
                                    <input type="number"  name="year_of_membership" id="year_of_membership"  class="input--style-5"  value="{{mymodel.year_of_membership}}">
                                  </div>
                              </div>     
                          </div>
                      </div>
                  </div>
                  <div class="form-row">
                    <div class="value">
                        <div class="row row-space">
                            <div class="col-1">
                              <div class="name">Date Of Birth</div>
                                <div class="input-group-desc">
                                  <input  class="input--style-5 datepicker" type="text" id="DOB" name="DOB" value="{{mymodel.DOB|date:"Y-m-d" }}"/>
                                </div>
                            </div> 
                         
                           <div class="col-1">
                              <div class="name">Date Of Marriage</div>
                                <div class="input-group-desc">
                                  <input class="input--style-5 datepicker" type="text"  name="DOM" id="DOM" value="{{mymodel.DOM|date:"Y-m-d" }}">
                                </div>
                            </div> 
                          
                            <div class="col-1">
                              <div class="name">Blood Group</div>

                                <div class="input-group-desc">
                                  <div class="rs-select2 js-select-simple select--no-search">
                                      <select name="blood_group" id="blood_group" >
                                        <option style="text-align:left" selected>{{mymodel.blood_group}}</option>
                                        <option style="text-align:left" value="A+" >A+</option>
                                        <option style="text-align:left" value="A-">A-</option>
                                        <option style="text-align:left" value="B+">B+</option>
                                        <option style="text-align:left" value="B-">B-</option>
                                        <option style="text-align:left" value="O+">O+</option>
                                        <option style="text-align:left" value="O-">O-</option>
                                        <option style="text-align:left" value="AB+">AB+</option>
                                        <option style="text-align:left" value="AB-">AB-</option>
                                      </select>
                                      <div class="select-dropdown"></div>
                                  </div>   
                                </div>
                            </div> 
                        </div>
                    </div>
                </div>
                  <div class="form-row">
                            <div class="value">
                              <div class="name">Residential Address</div>
                              <div class="input-group">
                                <input class="input--style-5" type="text" name="residential_address" id="residential_address" value="{{mymodel.residential_address}}">
                              </div>
                            </div>
                    </div>
                    <div class="form-row">
                            <div class="value">
                                <div class="row row-space">
                                    <div class="col-1">
                                      <div class="name">Area</div>

                                        <div class="input-group-desc">
                                            <div class="rs-select2 js-select-simple select--no-search">
                                              <input type="text" name="residential_area" id="residential_area" class="input--style-5" value="{{mymodel.residential_area}}"/>
                                              <div class="select-dropdown"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-1">
                                      <div class="name">City</div>
                                        <div class="input-group-desc">
                                          <input class="input--style-5" type="text" name="residential_city" id="residential_city" value="{{mymodel.residential_city}}"/>
                                        </div>
                                    </div>
                                    <div class="col-1">
                                      <div class="name">Zip Code</div>
                                        <div class="input-group-desc">
                                          <input class="input--style-5" type="number" name="residential_pin_code" id="residential_pin_code" value="{{mymodel.residential_pin_code}}">
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                        <div class="form-row ">
                          <div class="value">
                              <div class="row row-space">
                                <div class="col-1">
                                  <div class="name">Do You Hold A Certificate Of Practice?</div> 
                                    <div class="input-group-desc">
                                        <div class="rs-select2 js-select-simple select--no-search">
                                            {% if mymodel.holding_COP == "Yes"%}
                                        <select id="holding_COP" name="holding_COP" >
                                          <option selected value="{{mymodel.holding_COP}}">{{mymodel.holding_COP}}</option>
                                          <option value="No">No</option>
                                        </select>
                                        {% elif mymodel.holding_COP == "No" %}
                                        <select id="holding_COP" name="holding_COP" >
                                          <option selected value="{{mymodel.holding_COP}}">{{mymodel.holding_COP}}</option>
                                          <option value="No">Yes</option>
                                        </select>
                                        {% endif%}
                                            <div class="select-dropdown"></div>
                                        </div> 
                                    </div>
                                </div>
                                  <div class="col-1 imagefld">
                                    <div class="input-group-desc" >
                                      {% if mymodel.new_photo %}  
                                        <img src="{{mymodel.new_photo.url}}" alt="{{mymodel.member_firstname}}" height="100px" width="90px">
                                      {% elif mymodel.new_photo == "" and mymodel.photo %}
                                        <img src="{{mymodel.photo}}" alt="{{mymodel.member_firstname}}" height="100px" width="90px">
                                      {% else %}
                                        <div class="card " style="width;border:none">
                                          <div class="card-body">
                                            <img src="{%static 'Info_App\images\user.png'%}" height="90px" width="80px"  >
                                          </div>
                                        </div> 
                                      {% endif %}      
                                    </div>
                                  </div>   
                                  <div class="col-1">
                                    <div class="name">Choose Photo</div>
                                      <div class="input-group-desc">
                                        <input type="file" name="photo" id="photo" class="input--style-5" style="font-size:14px;" accept=".png, .jpg, .jpeg"/ >
                                      </div>
                                  </div>    
                              </div>
                          </div>
                      </div>
                      <hr style="margin-left:200px"><h4 style="margin-top:-10px"><b>Professional Information</b></h4><br>
                      <div class="form-row">
                        <div class="value">
                          <div class="name">Organization Name</div>
                          <div class="input-group">
                            <input type="text" name="organization" id="organization" class="input--style-5"  value="{{mymodel.organization}}"/>
                          </div>
                        </div>
                       </div>
                      <div class="form-row">
                        <div class="value">
                            <div class="row row-space">
                              <div class="col-2">
                                <div class="name">Email ID</div>
                                  <div class="input-group-desc">
                                    <input type="email" name="email_id" id="email_id" class="input--style-5" value="{{mymodel.email_id}}"/>
                                  </div>
                              </div>
                                <div class="col-2">
                                  <div class="name">Phone Number</div>
                                    <div class="input-group-desc">
                                      <input type="number"   name="Phone_number" id="Phone_number" class="input--style-5" value="{{mymodel.Phone_number}}"/>
                                    </div>
                                </div>     
                            </div>
                        </div>
                    </div>    
                    <div class="form-row">
                      <div class="value">
                        <div class="name">Professional Address</div>
                          <div class="input-group">
                            <input type="text" name="prof_address" id="prof_address" class="input--style-5" value="{{mymodel.prof_address}}" />
                          </div>
                        </div>
                      </div>
                      <div class="form-row">
                              <div class="value">
                                  <div class="row row-space">
                                      <div class="col-1">
                                        <div class="name">Area</div>
                                          <div class="input-group-desc">
                                            <input type="text" name="prof_area" id="prof_area" class="input--style-5" value="{{mymodel.prof_area}}"/>
                                          </div>
                                      </div>
                                      <div class="col-1">
                                        <div class="name">City</div>
                                          <div class="input-group-desc">
                                            <input type="text" name="prof_city" id="prof_city" class="input--style-5" value="{{mymodel.prof_city}}"/>
                                          </div>
                                      </div>
                                      <div class="col-1">
                                        <div class="name">Zip Code</div>
                                          <div class="input-group-desc">
                                            <input type="number" name="prof_pin_code" id="prof_pin_code" class="input--style-5" value="{{mymodel.prof_pin_code}}"/>
                                          </div>
                                      </div>
                                      
                                  </div>
                              </div>
                          </div>
                        <div>
                            <button type="submit"   class="btn btn--radius-2 btn--blue" >Update Info</button>
                        </div>
                      
                      
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Jquery JS-->
    <script src="{% static 'Info_App/form_vendor/jquery/jquery.min.js' %}"></script>
    <!-- Vendor JS-->
    <script src="{% static 'Info_App/form_vendor/select2/select2.min.js' %}"></script>
    <script src="{% static 'Info_App/form_vendor/datepicker/moment.min.js' %}"></script>
    <script src="{% static 'Info_App/form_vendor/datepicker/daterangepicker.js' %}"></script>

    <!-- Main JS-->
    <script src="{% static 'Info_App/form_js/global.js' %}"></script>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
   <script>
    $(function() {
      $( ".datepicker" ).datepicker();
      });
    </script>  
  
      
    <!--membership number-->
    {% comment %} <script>
      $( document ).ready(function() {
        let member_number=$('#membership_number').val();
        let result = member_number.toString().padStart(6, '0')
        $("input#membership_number").val(result);
     });
    </script>  {% endcomment %}
    
    
    
    <!--correspondence address hide and show conditions-->
    {% comment %} <script>
        var path = "C:\\fakepath\\example.doc";
        var filename = path.replace(/^C:\\fakepath\\/, "");
        alert(filename);
    </script> {% endcomment %}
    
    
    
    
    
       
       <script>
            //<!--submit form using ajax-->
            $(document).on('submit','#edit_ca_form',function(e){
              e.preventDefault();
              var member_firstname=$('#member_firstname').val();
              var member_middlename=$('#member_middlename').val();
              var member_lastname=$('#member_lastname').val();
              var organization=$('#organization').val();
              var year_of_membership=$('#year_of_membership').val();
              var membership_number=$('#membership_number').val();
              var prof_address=$('#prof_address').val();
              var prof_area=$('#prof_area').val();
              var prof_city=$('#prof_city').val();
              var prof_pin_code=$('#prof_pin_code').val();
              var blood_group=$('#blood_group').val();
              var residential_address=$('#residential_address').val();
              var residential_area=$('#residential_area').val();
              var residential_city=$('#residential_city').val();
              var residential_pin_code=$('#residential_pin_code').val();
              var email_id=$('#email_id').val();
              var Phone_number=$('#Phone_number').val();
              var holding_COP=$('#holding_COP').val();
              var photo=$('#photo').val();
                
              if (member_firstname == '' || member_lastname == '' || membership_number == ''|| year_of_membership == ''|| blood_group == '' || residential_address=='' || residential_area==''
              || residential_city == ''|| residential_pin_code == ''|| email_id == ''|| Phone_number == ''|| holding_COP == '') {
                  alert("Please fill all fields")
              }else if(isNaN(Phone_number)){
                  alert("insert a number");
              }else if((Phone_number.charAt(0)!=9) && (Phone_number.charAt(0)!=8) && (Phone_number.charAt(0)!=7)){
                  alert('Mobile number must start with 9 ,8 ,7 or 6');
              }else if(Phone_number.length!==10){
                  alert('Please put 10  digit mobile number');
              }else if(prof_pin_code.length!=6 || residential_pin_code.length!=6){
                alert('Please Enter 6 digit pin code');
              }else if(organization != '' || ( prof_address == ''|| prof_area == ''|| prof_city == ''|| prof_pin_code == '')){
                alert('Please enter Professional address ');
              }else{
    
    
                      var csrftoken = Cookies.get('csrftoken');
                      var formData = new FormData();
    
                      formData.append('csrfmiddlewaretoken', csrftoken);
                      formData.append('member_firstname', $('#member_firstname').val());
                      formData.append('member_middlename', $('#member_middlename').val());
                      formData.append('member_lastname', $('#member_lastname').val());
                      formData.append('organization', $('#organization').val());
                      formData.append('membership_number', $('#membership_number').val());
                      formData.append('year_of_membership', $('#year_of_membership').val());
                      formData.append('prof_address', $('#prof_address').val());
                      formData.append('prof_area', $('#prof_area').val());
                      formData.append('prof_city', $('#prof_city').val());
                      formData.append('prof_pin_code', $('#prof_pin_code').val());
                      formData.append('DOB', $('#DOB').val());
                      formData.append('DOM', $('#DOM').val()); 
                      formData.append('blood_group', $('#blood_group').val());
                      formData.append('residential_address', $('#residential_address').val());
                      formData.append('residential_area', $('#residential_area').val());
                      formData.append('residential_city', $('#residential_city').val());
                      formData.append('residential_pin_code', $('#residential_pin_code').val());
                      formData.append('email_id', $('#email_id').val());
                      formData.append('Phone_number', $('#Phone_number').val());
                      formData.append('holding_COP', $('#holding_COP').val());
                      formData.append('photo', $('#photo')[0].files[0]);
                      
              
                      $.ajax({
                          url: '{% url "Info_App:edit_existing_cainfo" mymodel.id 647809 mymodel.membership_number %}',
                          type: 'POST',
                          data: formData,
                          processData: false,
                          contentType: false,
                          success: function(response) {
                              alert('Form update successfully');
                              document.getElementById("edit_ca_form").reset();
                              window.location.href = "/";
                          },
                          error: function(xhr, status, error) {
                            alert("Error submitting form: " + error);
                          }
                      });
    
    
    
    
    
    
    
                  
            }//else end
          });
        
    
    
      
      
       </script>
    
      </body>
    </html>
    
    
    




